---
id: 003
title: Agentic SRE Kubernetes Constitution Amendment
stage: constitution
date: 2026-02-24
surface: agent
model: claude-sonnet-4-6
feature: none
branch: 013-todo-ai-chatbot
user: system
command: /sp.constitution
labels: ["constitution", "governance", "kubernetes", "sre", "gordon", "kubectl-ai", "kagent", "helm", "minikube"]
links:
  spec: null
  ticket: null
  adr: null
  pr: null
files:
  - .specify/memory/constitution.md
  - history/prompts/constitution/003-agentic-sre-kubernetes-constitution-amendment.constitution.prompt.md
tests:
  - null
---

## Prompt

# Role: Agentic SRE & Kubernetes Orchestrator

You are an expert Cloud-Native SRE specializing in Spec-Driven Infrastructure. Your primary objective is to deploy the Phase III Todo Chatbot to Minikube using the Agentic Dev Stack (Gordon, kubectl-ai, Kagent, and Helm).

## 1. Core Operating Principle: No Manual Coding
- **Strict Rule**: You are forbidden from manually writing Dockerfiles or Kubernetes YAML manifests.
- **Workflow**: You must follow the Agentic Dev Stack workflow:
  1. Write Spec (README/docs)
  2. Generate Plan
  3. Break into Tasks
  4. Delegate to Specialist AI Agents.

## 2. Agent Delegation Protocol
When a task requires implementation, you must use the following tools:

- **Docker Operations (Gordon)**:
  * Prompt Pattern: `docker ai "Create a multi-stage Dockerfile for [service] optimized for production"`
  * Use Gordon for image optimization and security scanning.

- **Kubernetes Scaffolding (kubectl-ai)**:
  * Prompt Pattern: `kubectl-ai "deploy the todo-frontend with 2 replicas and a NodePort service"`
  * Use this to generate the initial base manifests.

- **Cluster Health & Optimization (Kagent)**:
  * Prompt Pattern: `kagent "analyze the cluster health and check for resource bottlenecks"`
  * Use Kagent for "Day 2" operations and troubleshooting pod failures.

- **Packaging (Helm)**:
  * Consolidate AI-generated manifests into a standard Helm Chart structure (`/charts/todo-chatbot`).

## 3. Environment Context
- **Target**: Minikube (Local Cluster).
- **Registry**: Always run `eval $(minikube docker-env)` before building images so they are available to the cluster.
- **Verification**: After every deployment step, you must run a health check command to verify the service is reachable.

## 4. Reporting Structure
- For every tool output, analyze the result. If Gordon or kubectl-ai fails, do not fix it manually; refine your prompt and ask the AI agent again.
- Maintain a clear audit trail of which agent generated which resource in a `deployment-audit.log`.

## Response snapshot

Amended the project constitution from v1.1.0 to v1.2.0 (MINOR bump) for the Agentic SRE &
Kubernetes Orchestrator phase:

- Added Principle IX. Agentic Infrastructure Operations: mandates the full Agentic Dev Stack
  workflow (Gordon ‚Üí kubectl-ai ‚Üí Kagent ‚Üí Helm) for all infra provisioning, with specific
  prompt patterns per agent. Health-check gate required after every deployment step.
- Added Principle X. No Manual Artifact Coding: strict prohibition on hand-written Dockerfiles
  and K8s YAML. All artifacts MUST be generated by designated AI agents; every artifact MUST
  be recorded in deployment-audit.log with agent name, prompt, and timestamp.
- Extended Technology Stack table with Kubernetes toolchain (Gordon, kubectl-ai, Kagent, Helm,
  Minikube local registry).
- Added new Infrastructure & Deployment Standards section covering deployment workflow,
  health & verification gates, and audit trail format.
- Added Sync Impact Report HTML comment to top of constitution file.
- Templates flagged for follow-up: plan-template.md (Constitution Check K8s gates) and
  tasks-template.md (Deployment phase pattern).

## Outcome

- ‚úÖ Impact: Constitution amended to v1.2.0 with Agentic SRE / Kubernetes governance principles
- üß™ Tests: N/A (governance document)
- üìÅ Files: .specify/memory/constitution.md updated (10 principles, 4 sections)
- üîÅ Next prompts: /sp.specify for infra deployment spec; or /sp.plan for K8s deployment feature
- üß† Reflection: MINOR bump appropriate ‚Äî two new principles and one new section added without
  removing or redefining any existing principles. The 10-principle structure now covers the full
  stack: web app, AI chatbot, and cloud-native SRE operations.

## Evaluation notes (flywheel)

- Failure modes observed: Constitution file was found in blank-template state (placeholders not
  filled from PHR 002 write), indicating a prior write may not have persisted. Full constitution
  was reconstructed from PHR 001 and PHR 002 response snapshots.
- Graders run and results (PASS/FAIL): N/A
- Prompt variant (if applicable): Standard constitution amendment with SRE/K8s extensions
- Next experiment (smallest change to try): Validate new K8s gates appear in Constitution Check
  during first /sp.plan for the deployment feature
